VP
barplot(VP$values)
abline(h=mean(VP$values))
CP=VP$values/sum(VP$values)
VP
exp(1)
?pairs
random(1:10, 1)
sample(10, 3)
sample(10, 10)
sample(12, 10)
setwd("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/interpolation")
library(ggplot2)
library(ggpubr)
data<-read.csv("complete_traits.csv", h=T, sep=";")
head(data)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
("Rapport longueur sur largeur")
ggarrange(p1, p2)
setwd("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/interpolation")
library(ggplot2)
library(ggpubr)
data<-read.csv("complete_traits.csv", h=T, sep=";")
head(data)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
("Rapport longueur sur largeur")
ggarrange(p1, p2)
ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Largeur moyenne")
ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
("Rapport longueur sur largeur")
head(data)
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
("Rapport longueur sur largeur")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=50, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=50, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=50, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
ggsave("sst_climatology_2003_2020_bins50.png",  width = 20, height = 20, units = "cm")
ggsave("sst_climatology_2003_2020_bins50.png",  width = 20, height = 10, units = "cm")
ggsave("hist_bins50.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=65, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=65, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=60, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
nrow(data)
geom_histogram()
?geom_histogram()
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur", breaks=1)
ggarrange(p1, p2)
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black", breaks=1)+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black", breaks=1)+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")
ggarrange(p1, p2)
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black",  cex=1)+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black",  cex=0.5)+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))+
theme(axis.text.x = element_text(size=7))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))
ggarrange(p1, p2)
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))+
theme(axis.text.x = element_text(size=7))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))+
theme(axis.text.x = element_text(size=7))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 5))+
theme(axis.text.x = element_text(size=5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))+
theme(axis.text.x = element_text(size=5))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 1))+
theme(axis.text.x = element_text(size=5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))+
theme(axis.text.x = element_text(size=5))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 2))+
theme(axis.text.x = element_text(size=5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))+
theme(axis.text.x = element_text(size=5))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
p1<-ggplot(data, aes(x=larg_mean))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Largeur moyenne")+
scale_x_continuous(breaks = seq(0, 125, 3))+
theme(axis.text.x = element_text(size=5))
p2<-ggplot(data, aes(x=rapport_lon_.larg))+
geom_histogram(bins=75, fill="white", color="black")+
xlab("Rapport longueur sur largeur")+
scale_x_continuous(breaks = seq(0, 2, 0.2))+
theme(axis.text.x = element_text(size=5))
ggarrange(p1, p2)
ggsave("hist_bins60.png",  width = 20, height = 10, units = "cm")
setwd("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R")
#spp_traits = feuille "Copy of complet" dans le fichier "trait complet"
spp_traits <- read_csv("spp_traits.csv",
+     col_types = cols(`profondeur min (m)` = col_skip(),
+         `profondeur max (m)` = col_skip(),
+         `long Moy` = col_skip(), `larg Moy` = col_skip(),
+         `rapport long/larg` = col_skip(),
+         `division du rostre` = col_character()))
#spp_traits = feuille "Copy of complet" dans le fichier "trait complet"
spp_traits <- read_csv("spp_traits.csv",
+     col_types = cols(`profondeur min (m)` = col_skip(),
+         `profondeur max (m)` = col_skip(),
+         `long Moy` = col_skip(), `larg Moy` = col_skip(),
+         `rapport long/larg` = col_skip(),
+         `division du rostre` = col_character()))
library(readr)
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/spp_traits.csv")
View(spp_traits)
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/spp_traits.csv")
res=MCA(data_ql)
plot.MCA(res)
library(FactoMineR)
library(missMDA)      #remplace les NA par des données en fonction de la liaison entre les variables
library(FactoInvestigate)
res=MCA(data_ql)
data=spp_traits
data_ql=data
data_ql=data_ql[,-1] #deux fois
res=MCA(data_ql)
data_ql
data_ql=data_ql[,-1] #deux fois
res=MCA(data_ql)
data_ql
MCA(data_ql)
colnames(data_ql)
plot.MCA(res)
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/spp_traits.csv")
data=spp_traits
data_ql=data
data_ql=data_ql[,-1] #deux fois
data_ql=data_ql[,-1] #deux fois
res=MCA(data_ql)
spp_traits
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/spp_traits.csv")
data=spp_traits
data_ql=data
data_ql=data_ql[,-1] #deux fois
data_ql=data_ql[,-1] #deux fois
data_ql
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/trats_sfr.csv")
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv")
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv")
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv")
spp_traits
spp_traits <- read_csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T)
spp_traits <- read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
library(tidyerse)
library(tydiverse)
library(tydiverse)
library(tidyverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql
data_ql=data_ql[,-c(1:3)] #deux fois
res=MCA(data_ql)
data_ql)
data_ql
library(tydiverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
res=MCA(data_ql)
library(tydiverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
data_ql
MCA(data_ql)
data.frame(MCA(data_ql))
data.frame(data_ql)
library(tydiverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
data.frame(MCA(data_ql))
data.frame(data_ql)
library(tydiverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
data.frame(data_ql)
res=MCA(data_ql)
library(tydiverse)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
data_ql
MCA(data_ql)
data_ql<-as.factor(data_ql)
apply(data_ql, 2, as.factor(x))
apply(data_ql, 2, function(x){as.factor(x)})
apply(data_ql, 2, function(x){as.factor(as.character(x))})
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T, na.strings=c("","NA")))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
apply(data_ql, 2, function(x){as.factor(as.character(x))})
res=MCA(data_ql)
data_ql
apply(data_ql, 2, function(x){as.factor(as.character(x))})
data<-apply(data_ql, 2, function(x){as.factor(as.character(x))})
res=MCA(data_ql)
spp_traits <- as_tibble(read.csv("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R/traits_sfr.csv", sep=";", h=T, na.strings=c("","NA")))
data=spp_traits
data_ql=data
data_ql=data_ql[,-c(1:3)] #deux fois
data<-apply(data_ql, 2, function(x){factor(as.character(x))})
data
names(data)
data<-data.frame(apply(data_ql, 2, function(x){factor(as.character(x))}))
data
data$peu_profond
data<-data.frame(apply(data_ql, 2, factor)
data<-data.frame(apply(data_ql, 2, factor))
data$peu_profond
data<-data.frame(apply(data_ql, 2, as.factor))
data
data$peu_profond
res=MCA(data_ql)
names(data)
data.frame(apply(data_ql, 2, as.factor))
apply(data_ql, 2, as.factor)
?MCA
data(tea)
tea
tea$breakfast
data<-data.frame(apply(data_ql, 2, function(x){as.factor(as.character(x))}))
data
data$peu_profond
data <- data %>% mutate_if(is.character,as.factor)
data
data $peu_profond
res=MCA(data_ql)
res=MCA(data)
plot.MCA(res)
res=MCA(data)
plot.MCA(res)
nb<-estim_ncpMCA(data_ql)
nb
nb<-estim_ncpMCA(data)
nb
complet<-imputeMCA(data_ql, ncp=3)
complet<-imputeMCA(data, ncp=3)
complet$tab.disj
View(complet$tab.disj)
res<-MCA(data, tab.disj = complet$tab.disj)
plot.MCA(res, invisible=c("ind", "var"))
nb
sum(nb$criterion)
?estim_ncpMCA
complet<-imputeMCA(data, ncp=3,  ncp.max=10)
nb<-estim_ncpMCA(data,   ncp.max=10)
?plot.MCA
plot.MCA(res)
res
res$call
data
names(data)
plot.MCA(res, col.var=randomColor(count = 14))
install.packages("randomcoloR")
plot.MCA(res, col.var=randomColor(count = 14))
library(randomcoloR)
plot.MCA(res, col.var=randomColor(count = 14))
plot.MCA(res)
res
plot.MCA(res)
plot(res)
res
res$var
str(res)
plot(res, col.var=randomColor(count=14♦))
plot(res, col.var=randomColor(count=14))
plot(res, col.var=randomColor(count=50))
res
plot(res, col.var=randomColor(count=14))
res$eig
res$var
res$call
res$ind
str(res$ind)
str(res$svd)
str(res$var)
str(res$var$contrib)
str(res$var$coord)
str(res$var$cos2)
str(res$var$v.test)
res
res<-MCA(data, tab.disj = complet$tab.disj)
nb
nb<-estim_ncpMCA(data,   ncp.max=7)
nb<-estim_ncpMCA(data,   ncp.max=5)
sum(nb$criterion[1:3])
str(res)
plot(res, axes=c(1,3))
plot.MCA(res, axes=c(1,3))
plot.MCA(res, choix="var", axes=c(1,3))
plot.MCA(res, choix="var", axes=c(1,2))
plot.MCA(res, choix="var", axes=c(2,3))
ncol(data)
M <- as.table(rbind(c(76, 32, 46), c(48,23,47), c(45,34,78)))
dimnames(M) <- list(sex=c("Male","Female","Juv"),loc=c("Lower","Middle","Upper"))
M
# Shows post-hoc pairwise comparisons using fdr method
chisq.post.hoc(M)
install.packages("fifer")
library(fifer)
x <- sample(1:2, 1e3, TRUE)
g <- sample(1:4, 1e3, TRUE)
x
g
pairwise.chisq.test(x, g)
install.packages("rmngb")
library( rmngb)
install.packages("rmngb")
M <- as.table(rbind(c(76, 32, 46), c(48,23,47), c(45,34,78)))
dimnames(M) <- list(sex=c("Male","Female","Juv"),loc=c("Lower","Middle","Upper"))
M
# Shows post-hoc pairwise comparisons using fdr method
chisq.post.hoc(M)
install.packages("fifer")
install.packages("C:/Users/Salomé/Downloads/fifer_1.1.tar.gz", repos = NULL, type = "source")
z <- matrix(sample(1:2, 500, replace=TRUE), ncol=5)
chisq_colpairs(z)
install.packages("qtl2")
library(qtl2)
chisq_colpairs(z)
dummy
install.packages("FD")
library(FD)
dummy
ex1 <- functcomp(dummy$trait, dummy$abun)
ex1
matrix(c(6,10,
0.5,0,0,
0,0.4,0), nrow=3, ncol=3)
matrix(c(6,10,
0.5,0,0,
0,0.4,0),byrow=T, nrow=3, ncol=3)
matrix(c(6,10,
0.5,0,0,
0,0.4,0),byrow=F, nrow=3, ncol=3)
matrix(c(0,6,10,
0.5,0,0,
0,0.4,0),byrow=F, nrow=3, ncol=3)
matrix(c(0,6,10,
0.5,0,0,
0,0.4,0),byrow=T, nrow=3, ncol=3)
mat<-matrix(c(0,6,10,
0.5,0,0,
0,0.4,0),byrow=T, nrow=3, ncol=3)
mat<-matrix(c(0,6,10,
0.5,0,0,
0,0.4,0),byrow=T, nrow=3, ncol=3)
eigen(mat)
mat
0.5/25
0.4/5
0.5*25
10+12.5+50
0.02*25
0.6*25
10-15+5
0.02*25
0.08/5
0.4*0.5
05/2
0.5/2
0.4*0.25
6*0.25
0.1/2
10*0.05
0.4*0.25
2/0.5
0.4/2
2/0.4
0.4/2
10*0.2
2*4
2/0.4
2/0.5
2/0.4
0.4/2
10*0.2
sqrt(3)
2/0.4
sqrt(12)
source('~/.active-rstudio-document', encoding = 'UTF-8', echo=TRUE)
POIUY
mat<-matrix(c(0,6,10,
0.5,0,0,
0,0.4,0),byrow=T, nrow=3, ncol=3)
eigen(mat)
setwd("C:/Users/Salomé/Google Drive/ATER/Stages/Ines_Normand_Chebbi/R")
